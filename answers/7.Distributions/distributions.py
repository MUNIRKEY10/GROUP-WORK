# Python code for \"Distributions\"\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy import stats\nimport statsmodels.api as sm\nimport statsmodels.graphics.gofplots as smg\n\n# --- Random Number Generation ---\n# Example: runif() equivalent is np.random.rand()\nnp.random.seed(10) # Set seed for reproducibility\nprint(np.random.rand(10))\nnp.random.seed(10)\nprint(np.random.rand(10))\n\n# Linear Congruential Generator (LCG)\n# Python doesn\'t have global mutable variables in the same way, so we\'ll use a class\nclass LCG:\n  def __init__(self, seed, a, c, m):\n    self.seed = seed\n    self.a = a\n    self.c = c\n    self.m = m\n  \n  def next_random(self):\n    self.seed = (self.a * self.seed + self.c) % self.m\n    return self.seed\n\n# Test LCG with period 8 (a=5, c=12, m=16)\nseed = 10\nlcg1 = LCG(seed, a=5, c=12, m=16)\nout_length = 20\nvariates_lcg1 = np.array([lcg1.next_random() for _ in range(out_length)])\nprint(variates_lcg1)\n\n# Test LCG (a=131, c=7, m=16)\nseed = 10\nlcg2 = LCG(seed, a=131, c=7, m=16)\nvariates_lcg2 = np.array([lcg2.next_random() for _ in range(out_length)])\nprint(variates_lcg2)\n\n# Test LCG (a=129, c=7, m=16)\nseed = 10\nlcg3 = LCG(seed, a=129, c=7, m=16)\nvariates_lcg3 = np.array([lcg3.next_random() for _ in range(out_length)])\nprint(variates_lcg3)\n\n# Test LCG (a=1664545, c=1013904223, m=2**32)\nseed = 10\nlcg4 = LCG(seed, a=1664545, c=1013904223, m=2**32)\nvariates_lcg4 = np.array([lcg4.next_random() for _ in range(out_length)])\nprint(variates_lcg4)\n\n# --- Distributions in Python (pdf, cdf, ppf, rvs functions) ---\n# Exponential distribution: PDF and CDF\nthis_range = np.arange(0, 8.05, 0.05)\n\nplt.figure(figsize=(7, 5))\nplt.plot(this_range, stats.expon.pdf(this_range, scale=1/1), label=\"rate=1\", color=\"black\") # scale = 1/rate\nplt.plot(this_range, stats.expon.pdf(this_range, scale=1/0.5), label=\"rate=0.5\", color=\"red\")\nplt.plot(this_range, stats.expon.pdf(this_range, scale=1/0.2), label=\"rate=0.2\", color=\"blue\")\nplt.title(\"Exponential Distributions (PDF)\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.ylim(0, 1) # Set y-axis limits explicitly\nplt.legend()\nplt.savefig(\"exponential_pdf.pdf\")\nplt.close()\n\nplt.figure(figsize=(7, 5))\nplt.plot(this_range, stats.expon.cdf(this_range, scale=1/1), label=\"rate=1\", color=\"black\")\nplt.plot(this_range, stats.expon.cdf(this_range, scale=1/0.5), label=\"rate=0.5\", color=\"red\")\nplt.plot(this_range, stats.expon.cdf(this_range, scale=1/0.2), label=\"rate=0.2\", color=\"blue\")\nplt.title(\"Exponential Distributions (CDF)\")\nplt.xlabel(\"x\")\nplt.ylabel(\"P(X<x)\")\nplt.ylim(0, 1)\nplt.legend()\nplt.savefig(\"exponential_cdf.pdf\")\nplt.close()\n\n# --- Fitting Distributional Models ---\n# Method of Moments: Closed form (Gamma Distribution Example)\ndef gamma_est_MM(x):\n  m = np.mean(x)\n  v = np.var(x, ddof=1) # ddof=1 for sample variance\n  shape = m**2 / v\n  scale = v / m # In Python scipy.stats.gamma, scale is the inverse of R\'s rate parameter (1/rate)\n  # R\'s dgamma uses rate, fitdistr uses rate. So for comparison, Python scale = 1/rate\n  return {"shape": shape, "scale": scale}\n\n# Method of Moments: Numerically (Discrepancy function)\ndef gamma_mean(shape, scale):\n  return shape * scale\n\ndef gamma_var(shape, scale):\n  return shape * scale**2\n\ndef gamma_discrepancy(params, x): # params is a tuple (shape, scale)\n  shape, scale = params\n  return (np.mean(x) - gamma_mean(shape, scale))**2 + (np.var(x, ddof=1) - gamma_var(shape, scale))**2\n\n# --- Maximum Likelihood Estimation ---\n# Example: Cat heart weights (Creating a dummy cats dataframe similar to R\'s MASS::cats)\ncats_data = {\n    \'Sex\': [\'F\'] * 73 + [\'M\'] * 71,\n    \'Bwt\': np.random.normal(2.72, 0.5, 144),\n    \'Hwt\': np.random.normal(10.63, 3.0, 144) # Mean and SD from R summary\n}\ncats = pd.DataFrame(cats_data)\n\nplt.figure(figsize=(7, 5))\nsns.histplot(cats[\'Hwt\'], kde=True, bins=15)\nplt.title(\"Histogram of Cat Heart Weights\")\nplt.xlabel(\"Heart Weight\")\nplt.savefig(\"cats_hwt_hist.pdf\")\nplt.close()\n\n# Using scipy.stats.gamma.fit for MLE\n# Note: scipy.stats.gamma.fit returns (alpha (shape), loc, beta (scale))\n# We assume loc=0 for simple gamma distribution fitting (like R\'s default)\nshape_mle, loc_mle, scale_mle = stats.gamma.fit(cats[\'Hwt\'], floc=0)\ncats_mle_gamma = {"shape": shape_mle, "scale": scale_mle}\nprint(\"MLE Gamma Parameters (shape, scale):\", cats_mle_gamma)\n\n# Using Method of Moments estimates for comparison\ncats_gamma_mm = gamma_est_MM(cats[\'Hwt\'])\nprint(\"MM Gamma Parameters (shape, scale):\", cats_gamma_mm)\n\n# Checking the fit: QQ Plot\nplt.figure(figsize=(7, 5))\n# statsmodels qqplot for Gamma distribution\nsmg.qqplot(cats[\'Hwt\'], dist=stats.gamma, scale=cats_gamma_mm[\'scale\'], loc=0, fit=False, line=\'45d\', markerfacecolor=\'blue\', markeredgecolor=\'blue\')\nplt.title(\"QQ Plot: Cat Heart Weights vs. Gamma (MM)\")\nplt.xlabel(\"Theoretical Gamma Quantiles\")\nplt.ylabel(\"Observed Heart Weight\")\nplt.savefig(\"cats_hwt_qqplot_gamma.pdf\")\nplt.close()\n\nplt.figure(figsize=(7, 5))\nsmg.qqplot(cats[\'Hwt\'], dist=stats.gamma, scale=cats_mle_gamma[\'scale\'], loc=0, fit=False, line=\'45d\', markerfacecolor=\'green\', markeredgecolor=\'green\')\nplt.title(\"QQ Plot: Cat Heart Weights vs. Gamma (MLE)\")\nplt.xlabel(\"Theoretical Gamma Quantiles\")\nplt.ylabel(\"Observed Heart Weight\")\nplt.savefig(\"cats_hwt_qqplot_gamma_mle.pdf\")\nplt.close()\n\n# Checking the fit: Density plot overlay\nplt.figure(figsize=(7, 5))\nsns.histplot(cats[\'Hwt\'], stat=\"density\", bins=15, color=\"gray\", alpha=0.6, label=\"Empirical Density (Histogram)\")\n\n# Overlay MM Gamma PDF\nmm_x = np.linspace(cats[\'Hwt\'].min(), cats[\'Hwt\'].max(), 100)\nplt.plot(mm_x, stats.gamma.pdf(mm_x, a=cats_gamma_mm[\'shape\'], scale=cats_gamma_mm[\'scale\']), color=\"red\", linestyle=\"--\", label=\"Gamma (MM)\")\n# Overlay MLE Gamma PDF\nplt.plot(mm_x, stats.gamma.pdf(mm_x, a=cats_mle_gamma[\'shape\'], scale=cats_mle_gamma[\'scale\']), color=\"blue\", linestyle=\